<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Coze ä¸€é”®å¯åŠ¨æŒ‰é’®</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background: #f1f5f9; }
        .card { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center; width: 320px; }
        button { background: #10b981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; width: 100%; font-weight: bold; }
        button:hover { background: #059669; }
        button:disabled { background: #9ca3af; }
        #status { margin-top: 1rem; font-size: 13px; color: #64748b; }
    </style>
</head>
<body>
    <div class="card">
        <h3>æ‰£å­ä¸€é”®æ‰§è¡Œ</h3>
        <p style="font-size: 14px; color: #666;">æ£€æµ‹åˆ° Token åç‚¹å‡»å³å¯å¯åŠ¨</p>
        <button id="btn">å¯åŠ¨å·¥ä½œæµ</button>
        <div id="status">ç­‰å¾…æ“ä½œ...</div>
    </div>

    <script>
        const btn = document.getElementById('btn');
        const status = document.getElementById('status');
        const WORKFLOW_ID = "7600384889276547126";

        btn.addEventListener('click', async () => {
            // --- æ ¸å¿ƒé€»è¾‘ï¼šä» URL å‚æ•°è·å– Token ---
            const urlParams = new URLSearchParams(window.location.search);
            let token = urlParams.get('token');

            // å¦‚æœ URL é‡Œæ²¡ä¼ ï¼Œå°±å¼¹çª—é—®ä¸€æ¬¡
            if (!token) {
                token = prompt("URLä¸­æœªæ£€æµ‹åˆ°Tokenï¼Œè¯·æ‰‹åŠ¨è¾“å…¥ï¼š");
            }
            if (!token) return;

            // UI çŠ¶æ€
            btn.disabled = true;
            status.innerText = "ğŸš€ æ­£åœ¨å‘é€è¯·æ±‚...";

            try {
                const response = await fetch('https://api.coze.cn/v1/workflow/run', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ workflow_id: WORKFLOW_ID })
                });

                const result = await response.json();
                if (response.ok) {
                    status.innerText = "âœ… å¯åŠ¨æˆåŠŸï¼";
                    console.log(result);
                } else {
                    status.innerText = "âŒ å¤±è´¥ï¼š" + (result.msg || "æœªçŸ¥é”™è¯¯");
                }
            } catch (e) {
                status.innerText = "âŒ ç½‘ç»œé”™è¯¯: " + e.message;
            } finally {
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>
