<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2327 3D Âä®ÊÄÅÊï∞ÊçÆÂØπÊØîÂ∑•ÂÖ∑ - ÊúÄÁªàÂÆåÊï¥Â§çÂéüÁâà</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; font-family: 'Inter', sans-serif; background-color: #000; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        ::-webkit-scrollbar-thumb { background: rgba(59, 130, 246, 0.5); border-radius: 10px; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.0.0",
        "react-dom": "https://esm.sh/react-dom@19.0.0",
        "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
        "react/jsx-runtime": "https://esm.sh/react@19.0.0/jsx-runtime",
        "three": "https://esm.sh/three@0.174.0",
        "@react-three/fiber": "https://esm.sh/@react-three/fiber@9.0.0?external=react,react-dom,three",
        "@react-three/drei": "https://esm.sh/@react-three/drei@10.0.0?external=react,react-dom,three,@react-three/fiber",
        "lucide-react": "https://esm.sh/lucide-react@0.475.0?external=react"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module" data-presets="react">
        /** @jsx React.createElement */
        import React, { useRef, useMemo, useState, useEffect } from 'react';
        import ReactDOM from 'react-dom/client';
        import { Canvas, useThree, useFrame } from '@react-three/fiber';
        import { 
          OrbitControls, PerspectiveCamera, Environment, ContactShadows, 
          MeshReflectorMaterial, PerformanceMonitor, AdaptiveDpr, AdaptiveEvents,
          Grid, Text, Billboard, Sphere, Float
        } from '@react-three/drei';
        import * as THREE from 'three';
        import { Play, Pause, RotateCcw, Monitor, Camera, MousePointer2, Settings2, X, Layout, BarChart3, TrendingUp } from 'lucide-react';

        // ==========================================
        // ÂÖ®Â±ÄÈÖçÁΩÆÂå∫
        // ==========================================
        const const CONFIG = {
  "ui": {
    "title": "2024Âπ¥",
    "highlightTitle": "‰∏ñÁïåGDPÊéíÂêçTOP10",
    "subTitle": "Êï∞ÊçÆÊù•Ê∫êÔºöIMF & ‰∏ñÁïåÈì∂Ë°å (Âçï‰ΩçÔºö‰∏á‰∫øÁæéÂÖÉ)",
    "defaultMode": "BAR"
  },
  "data": [
    {
      "id": "1",
      "name": "ÁæéÂõΩ",
      "value": 29.2,
      "unit": "‰∏á‰∫ø",
      "color": "#d32f2f",
      "flag": "üá∫üá∏"
    },
    {
      "id": "2",
      "name": "‰∏≠ÂõΩ",
      "value": 18.94,
      "unit": "‰∏á‰∫ø",
      "color": "#f44336",
      "flag": "üá®üá≥"
    },
    {
      "id": "3",
      "name": "Âæ∑ÂõΩ",
      "value": 4.66,
      "unit": "‰∏á‰∫ø",
      "color": "#ff5722",
      "flag": "üá©üá™"
    },
    {
      "id": "4",
      "name": "Êó•Êú¨",
      "value": 4.04,
      "unit": "‰∏á‰∫ø",
      "color": "#ff9800",
      "flag": "üáØüáµ"
    },
    {
      "id": "5",
      "name": "Âç∞Â∫¶",
      "value": 3.98,
      "unit": "‰∏á‰∫ø",
      "color": "#ffc107",
      "flag": "üáÆüá≥"
    },
    {
      "id": "6",
      "name": "Ëã±ÂõΩ",
      "value": 3.64,
      "unit": "‰∏á‰∫ø",
      "color": "#cddc39",
      "flag": "üá¨üáß"
    },
    {
      "id": "7",
      "name": "Ê≥ïÂõΩ",
      "value": 3.16,
      "unit": "‰∏á‰∫ø",
      "color": "#8bc34a",
      "flag": "üá´üá∑"
    },
    {
      "id": "8",
      "name": "ÊÑèÂ§ßÂà©",
      "value": 2.37,
      "unit": "‰∏á‰∫ø",
      "color": "#4caf50",
      "flag": "üáÆüáπ"
    },
    {
      "id": "9",
      "name": "Âä†ÊãøÂ§ß",
      "value": 2.24,
      "unit": "‰∏á‰∫ø",
      "color": "#009688",
      "flag": "üá®üá¶"
    },
    {
      "id": "10",
      "name": "Â∑¥Ë•ø",
      "value": 2.18,
      "unit": "‰∏á‰∫ø",
      "color": "#00bcd4",
      "flag": "üáßüá∑"
    }
  ]
};

        const CameraView = { FREE: 'FREE', FRONT: 'FRONT', TOP: 'TOP', SIDE: 'SIDE', CINEMATIC: 'CINEMATIC', PANORAMA: 'PANORAMA' };

        // --- 3D Ê†∏ÂøÉÁªÑ‰ª∂ ---
        const BOX_GEOM = new THREE.BoxGeometry(2, 1, 2);
        const PLANE_GEOM = new THREE.PlaneGeometry(3.5, 3.5);

        const Bar = ({ item, index, total, progress, active }) => {
          const materialRef = useRef();
          const growth = Math.max(0, Math.min(1, progress - index));
          const height = Math.max(0.01, item.value * 0.1 * growth);
          const xPos = (index - (total - 1) / 2) * 3.5;

          useFrame(() => {
            if (materialRef.current) {
              const emissive = active ? 3.0 : (progress >= index + 1 ? 0.5 : 0);
              materialRef.current.emissiveIntensity = THREE.MathUtils.lerp(materialRef.current.emissiveIntensity, emissive, 0.1);
            }
          });

          return (
            <group position={[xPos, 0, 0]}>
              <mesh geometry={PLANE_GEOM} rotation={[-Math.PI / 2, 0, 0]} position={[0, -0.01, 0]}>
                <meshBasicMaterial color={item.color} transparent opacity={0.1 * Math.min(1, growth * 2)} />
              </mesh>
              <mesh geometry={BOX_GEOM} scale={[1, height, 1]} position={[0, height / 2, 0]}>
                <meshStandardMaterial ref={materialRef} color={item.color} emissive={item.color} roughness={0.2} metalness={0.8} transparent opacity={Math.min(1, growth * 2)} />
              </mesh>
              {growth > 0.1 && (
                <Billboard position={[0, item.value * 0.1 + 4, 0]}>
                  <Text position={[0, 2.2, 0]} fontSize={2.5} fillOpacity={Math.min(1, growth * 2)}>{item.flag}</Text>
                  <Text position={[0, 0.5, 0]} fontSize={0.7} fontWeight="bold" color="#fff" fillOpacity={Math.min(1, growth * 2)}>{item.name}</Text>
                  <Text position={[0, -0.8, 0]} fontSize={1.4} fontWeight="900" color={active ? "#fff" : item.color} fillOpacity={Math.min(1, growth * 2)}>{(item.value * growth).toFixed(1)}</Text>
                </Billboard>
              )}
            </group>
          );
        };

        const LineNode = ({ item, prevItem, index, total, progress, active }) => {
          const growth = Math.max(0, Math.min(1, progress - index));
          const targetY = item.value * 0.1;
          const xPos = (index - (total - 1) / 2) * 3.5;
          const prevX = index > 0 ? (index - 1 - (total - 1) / 2) * 3.5 : xPos;
          const prevY = prevItem ? prevItem.value * 0.1 : 0;

          const segment = useMemo(() => {
            if (!prevItem || index === 0 || growth <= 0) return null;
            const start = new THREE.Vector3(prevX, prevY, 0);
            const end = new THREE.Vector3(xPos, targetY, 0);
            const currentEnd = start.clone().lerpVectors(start, end, growth * (2 - growth));
            const direction = new THREE.Vector3().subVectors(currentEnd, start);
            const length = direction.length();
            if (length < 0.01) return null;
            const midpoint = new THREE.Vector3().addVectors(start, currentEnd).multiplyScalar(0.5);
            const quaternion = new THREE.Quaternion().setFromUnitVectors(new THREE.Vector3(0, 1, 0), direction.clone().normalize());
            return { midpoint, quaternion, length };
          }, [prevItem, index, prevX, prevY, xPos, targetY, growth]);

          return (
            <group>
              {segment && (
                <mesh position={segment.midpoint} quaternion={segment.quaternion}>
                  <cylinderGeometry args={[0.1, 0.1, segment.length, 12]} />
                  <meshStandardMaterial color={item.color} emissive={item.color} emissiveIntensity={active ? 10 : 2} transparent opacity={Math.min(1, growth * 2)} />
                </mesh>
              )}
              {growth > 0.1 && (
                <group position={[xPos, targetY, 0]}>
                  <Sphere args={[0.35, 32, 32]}><meshStandardMaterial color={item.color} emissive={item.color} emissiveIntensity={active ? 10 : 1} metalness={1} roughness={0} /></Sphere>
                  <Billboard position={[0, 5, 0]}>
                    <Text position={[0, 2.5, 0]} fontSize={3}>{item.flag}</Text>
                    <Text position={[0, 0.6, 0]} fontSize={0.8} fontWeight="black" color="#fff">{item.name}</Text>
                    <Text position={[0, -1, 0]} fontSize={1.8} fontWeight="black" color={active ? "#fff" : item.color}>{(item.value * (progress > index + 1 ? 1 : growth)).toFixed(1)}</Text>
                  </Billboard>
                </group>
              )}
            </group>
          );
        };

        const CameraController = ({ view, progress, data, isPlaying, camAngle, camDistance }) => {
          const { camera } = useThree();
          const controlsRef = useRef();
          const total = data.length;

          useFrame(() => {
            if (!controlsRef.current) return;
            const currentIdx = Math.max(0, Math.min(total - 1, progress));
            const xPos = (currentIdx - (total - 1) / 2) * 3.5;
            const height = data[Math.floor(currentIdx)].value * 0.1;

            if (view === CameraView.CINEMATIC) {
              const rad = (camAngle * Math.PI) / 180;
              controlsRef.current.target.lerp(new THREE.Vector3(xPos, height / 2 + 2, 0), 0.05);
              camera.position.lerp(new THREE.Vector3(xPos + Math.sin(rad) * camDistance, height / 2 + 10, Math.cos(rad) * camDistance), 0.05);
              controlsRef.current.update();
            } else if (view === CameraView.PANORAMA) {
              camera.position.lerp(new THREE.Vector3(0, 30, 80), 0.04);
              controlsRef.current.target.lerp(new THREE.Vector3(0, 5, 0), 0.04);
              controlsRef.current.update();
            } else if (view !== CameraView.FREE) {
              const targets = {
                [CameraView.FRONT]: [0, 15, 70],
                [CameraView.TOP]: [0, 100, 0.1],
                [CameraView.SIDE]: [-60, 10, 0]
              };
              const t = targets[view];
              if (t) {
                camera.position.lerp(new THREE.Vector3(...t), 0.05);
                controlsRef.current.target.lerp(new THREE.Vector3(0, 5, 0), 0.05);
                controlsRef.current.update();
              }
            }
          });
          return <OrbitControls ref={controlsRef} makeDefault enableDamping dampingFactor={0.05} enabled={view === CameraView.FREE || !isPlaying || view === CameraView.PANORAMA} />;
        };

        // --- UI ÁªÑ‰ª∂ (ÂäüËÉΩÂÖ®Â§çÂéü) ---
        const ControlsUI = (props) => {
          const [showSettings, setShowSettings] = useState(false);
          return (
            <div className="w-full flex flex-col items-center bg-[#050505] border-t border-white/5 shadow-2xl">
              <div className="w-full h-1.5 bg-white/5 relative cursor-pointer group">
                <div className="absolute left-0 top-0 h-full bg-blue-500 z-10 transition-all duration-300" style={{ width: `${(props.progress / props.total) * 100}%` }} />
                <input type="range" min="0" max={props.total} step="0.01" value={props.progress} onChange={(e) => props.setProgress(parseFloat(e.target.value))} className="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20" />
              </div>
              <div className="w-full max-w-7xl px-8 py-5 flex items-center justify-between gap-8 relative">
                <div className="flex items-center gap-5">
                  <button onClick={() => props.setIsPlaying(!props.isPlaying)} className={`w-14 h-14 rounded-full flex items-center justify-center transition-all transform active:scale-90 ${props.isPlaying ? 'bg-white text-black' : 'bg-blue-600 text-white shadow-[0_0_20px_rgba(37,99,235,0.4)]'}`}>
                    {props.isPlaying ? <Pause fill="currentColor" size={24} /> : <Play fill="currentColor" size={24} className="ml-1" />}
                  </button>
                  <button onClick={() => { props.setProgress(0); props.setIsPlaying(true); props.setView(CameraView.CINEMATIC); }} className="p-3 text-white/20 hover:text-white hover:bg-white/5 rounded-xl transition-all" title="ÈáçÁΩÆÊí≠Êîæ"><RotateCcw size={20} /></button>
                </div>
                
                <div className="flex items-center gap-4">
                  <div className="flex items-center bg-white/5 p-1 rounded-xl border border-white/5">
                     <button onClick={() => props.setVisMode('BAR')} className={`p-2.5 rounded-lg transition-all ${props.visMode === 'BAR' ? 'bg-white text-black' : 'text-white/30 hover:text-white'}`} title="Êü±Áä∂ÂõæÊ®°Âºè"><BarChart3 size={20} /></button>
                     <button onClick={() => props.setVisMode('LINE')} className={`p-2.5 rounded-lg transition-all ${props.visMode === 'LINE' ? 'bg-white text-black' : 'text-white/30 hover:text-white'}`} title="ÊäòÁ∫øÂõæÊ®°Âºè"><TrendingUp size={20} /></button>
                  </div>
                  <div className="flex items-center bg-white/5 p-1.5 rounded-2xl gap-1 border border-white/5 overflow-x-auto no-scrollbar">
                    {[ 
                      { id: CameraView.CINEMATIC, icon: <Camera size={16} />, label: 'Êô∫ËÉΩË∑üÈöè' }, 
                      { id: CameraView.PANORAMA, icon: <Layout size={16} />, label: 'ÂÖ®Â±ÄÂÖ®ÊôØ' }, 
                      { id: CameraView.FREE, icon: <MousePointer2 size={16} />, label: 'Ëá™Áî±ËßÜËßí' }, 
                      { id: CameraView.FRONT, icon: <Monitor size={16} />, label: 'Ê≠£ÂâçËßÜËßí' }
                    ].map((v) => (
                      <button key={v.id} onClick={() => props.setView(v.id)} className={`flex items-center gap-2 px-5 py-3 rounded-xl text-[11px] font-black uppercase tracking-[0.15em] transition-all whitespace-nowrap ${props.view === v.id ? 'bg-white text-black shadow-lg' : 'text-white/30 hover:text-white hover:bg-white/5'}`}>
                        {v.icon}<span className="hidden md:inline">{v.label}</span>
                      </button>
                    ))}
                  </div>
                </div>

                <div className="flex items-center gap-4">
                  <button onClick={() => setShowSettings(!showSettings)} className={`p-3.5 rounded-2xl transition-all border ${showSettings ? 'bg-blue-600 border-blue-400 text-white' : 'bg-white/5 border-white/5 text-white/40 hover:text-white'}`}>{showSettings ? <X size={22} /> : <Settings2 size={22} />}</button>
                </div>

                {showSettings && (
                  <div className="absolute bottom-[calc(100%+1rem)] right-8 w-80 bg-[#0c0c0c] border border-white/10 p-8 rounded-3xl shadow-2xl z-50 flex flex-col gap-8 animate-in slide-in-from-bottom-4 duration-300">
                    <h3 className="text-[10px] font-black text-blue-500 uppercase tracking-[0.2em] border-b border-white/10 pb-4">Ê∏≤Êüì‰∏éÊÄßËÉΩÈÖçÁΩÆ</h3>
                    <div className="flex flex-col gap-3">
                      <div className="flex justify-between items-center"><span className="text-[10px] font-bold text-white/50 uppercase">Êí≠ÊîæÈÄüÁéá</span><span className="text-xs font-black text-blue-400">{props.speed.toFixed(1)}x</span></div>
                      <input type="range" min="0.2" max="3.0" step="0.1" value={props.speed} onChange={(e) => props.setSpeed(parseFloat(e.target.value))} className="w-full accent-blue-500 h-1 bg-white/10 rounded-full appearance-none cursor-pointer" />
                    </div>
                    <div className="flex flex-col gap-3">
                      <div className="flex justify-between items-center"><span className="text-[10px] font-bold text-white/50 uppercase">ËßÇÊµãÂÅèËßí</span><span className="text-xs font-black text-blue-400">{props.angle}¬∞</span></div>
                      <input type="range" min="0" max="360" step="1" value={props.angle} onChange={(e) => props.setAngle(parseInt(e.target.value))} className="w-full accent-blue-500 h-1 bg-white/10 rounded-full appearance-none cursor-pointer" />
                    </div>
                    <div className="flex flex-col gap-3">
                      <div className="flex justify-between items-center"><span className="text-[10px] font-bold text-white/50 uppercase">Áõ∏Êú∫Ë∑ùÁ¶ª</span><span className="text-xs font-black text-blue-400">{props.distance}m</span></div>
                      <input type="range" min="15" max="100" step="1" value={props.distance} onChange={(e) => props.setDistance(parseInt(e.target.value))} className="w-full accent-blue-500 h-1 bg-white/10 rounded-full appearance-none cursor-pointer" />
                    </div>
                  </div>
                )}
              </div>
              <div className="h-6 w-full" />
            </div>
          );
        };

        const App = () => {
          const [progress, setProgress] = useState(0);
          const [isPlaying, setIsPlaying] = useState(true);
          const [view, setView] = useState(CameraView.CINEMATIC);
          const [visMode, setVisMode] = useState(CONFIG.ui.defaultMode);
          const [playbackSpeed, setPlaybackSpeed] = useState(1.0);
          const [camAngle, setCamAngle] = useState(30); 
          const [camDistance, setCamDistance] = useState(45); 

          const totalItems = CONFIG.data.length;

          useEffect(() => {
            if (!isPlaying) return;
            const animate = () => {
              setProgress(prev => {
                let next = prev + (0.004 * playbackSpeed);
                if (next >= totalItems) { setIsPlaying(false); setView(CameraView.PANORAMA); return totalItems; }
                return next;
              });
              requestAnimationFrame(animate);
            };
            const id = requestAnimationFrame(animate);
            return () => cancelAnimationFrame(id);
          }, [isPlaying, totalItems, playbackSpeed]);

          return (
            <div className="flex flex-col w-full h-[100dvh] bg-black text-white select-none">
              <div className="relative flex-grow w-full bg-black overflow-hidden">
                <div className="absolute top-0 left-0 p-8 z-10 pointer-events-none">
                  <h1 className="text-white text-xl md:text-3xl font-black tracking-tighter uppercase italic">{CONFIG.ui.title} <span className="text-blue-500">{CONFIG.ui.highlightTitle}</span></h1>
                  <p className="text-blue-400 text-[9px] font-bold uppercase tracking-[0.4em] opacity-50 uppercase">{CONFIG.ui.subTitle}</p>
                </div>
                
                <Canvas dpr={[1, 2]}>
                  <Environment preset="night" /><fog attach="fog" args={['#000', 30, 400]} />
                  <CameraController view={view} progress={progress} data={CONFIG.data} isPlaying={isPlaying} camAngle={camAngle} camDistance={camDistance} />
                  <directionalLight position={[10, 20, 10]} intensity={1.5} />
                  <group>
                    <Grid infiniteGrid sectionColor="#111" cellColor="#050505" />
                    {visMode === 'BAR' ? 
                      CONFIG.data.map((item, idx) => <Bar key={item.id} item={item} index={idx} total={totalItems} progress={progress} active={Math.floor(progress) === idx} />) :
                      CONFIG.data.map((item, idx) => <LineNode key={item.id} item={item} prevItem={idx > 0 ? CONFIG.data[idx-1] : null} index={idx} total={totalItems} progress={progress} active={Math.floor(progress) === idx} />)
                    }
                    <mesh rotation={[-Math.PI / 2, 0, 0]} position={[0, -0.02, 0]}>
                      <planeGeometry args={[1000, 1000]} />
                      <MeshReflectorMaterial color="#080808" metalness={0.5} mirror={0.8} />
                    </mesh>
                    <ContactShadows opacity={0.4} scale={200} blur={3} color="#000" />
                  </group>
                </Canvas>

                <div className="absolute bottom-32 left-8 hidden md:block">
                  <div className="flex flex-col gap-1">
                    <span className="text-[10px] font-bold text-white/30 uppercase">ÂΩìÂâçÁÑ¶ÁÇπ</span>
                    <span className="text-lg font-black text-blue-500 italic uppercase">
                      {CONFIG.data[Math.min(totalItems-1, Math.floor(progress))]?.name || 'Â±ïÁ§∫ÂÆåÊØï'}
                    </span>
                  </div>
                </div>
              </div>
              <ControlsUI 
                isPlaying={isPlaying} setIsPlaying={setIsPlaying} progress={progress} setProgress={setProgress} 
                total={totalItems} view={view} setView={setView} visMode={visMode} setVisMode={setVisMode} 
                speed={playbackSpeed} setSpeed={setPlaybackSpeed} angle={camAngle} setAngle={setCamAngle} 
                distance={camDistance} setDistance={setCamDistance} 
              />
            </div>
          );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
